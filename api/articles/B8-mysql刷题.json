{"title":"mysql刷题","uid":"4d4adb38002129eb79b23e1030e48e77","slug":"B8-mysql刷题","date":"2021-11-26T03:03:44.000Z","updated":"2021-12-07T09:34:28.982Z","comments":true,"path":"api/articles/B8-mysql刷题.json","keywords":null,"cover":"https://img-blog.csdnimg.cn/5a00e96f5e504fcf98754e024e63506a.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWUZSNzE4,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center","content":"<h2 id=\"笔记\"><a href=\"#笔记\" class=\"headerlink\" title=\"笔记\"></a>笔记</h2><h4 id=\"空值输出null\"><a href=\"#空值输出null\" class=\"headerlink\" title=\"空值输出null\"></a>空值输出null</h4><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">select ifnull((select ... from ...),null) as ans;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h4 id=\"获取去重的第k名\"><a href=\"#获取去重的第k名\" class=\"headerlink\" title=\"获取去重的第k名\"></a>获取去重的第k名</h4><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">select ... from \ngroup by ...\norder by ... desc\nlimit k-1,1 ;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"删除操作，保留一部分\"><a href=\"#删除操作，保留一部分\" class=\"headerlink\" title=\"删除操作，保留一部分\"></a>删除操作，保留一部分</h4><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">delect from tablename\nwhere id not in (子查询)#要保留的<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h4 id=\"先select再delect会报错，中间要再加一层select\"><a href=\"#先select再delect会报错，中间要再加一层select\" class=\"headerlink\" title=\"先select再delect会报错，中间要再加一层select\"></a>先select再delect会报错，中间要再加一层select</h4><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">delete\nfrom contacts\nwhere id not in (\n    select * from (\n    select min(id) \n    from contacts \n    group by name) t\n);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"from-子查询-，子查询要起别名\"><a href=\"#from-子查询-，子查询要起别名\" class=\"headerlink\" title=\"from 子查询 ，子查询要起别名\"></a>from 子查询 ，子查询要起别名</h4><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">\nselect * from (\n    min(id)             \n    from contacts             \n    group by name) as t\n)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"in子查询可以-in-一对数据\"><a href=\"#in子查询可以-in-一对数据\" class=\"headerlink\" title=\"in子查询可以 in 一对数据\"></a>in子查询可以 in 一对数据</h4><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">#查询每位同学第一次登录平台听课的设备ID (device_id)。\nselect o.student_id,o.device_id\nfrom online_class_situations  as o\nwhere (o.student_id,o.date) in (\n    select distinct student_id,min(date)\n    from online_class_situations\n    where course_number&gt;0\n    group by student_id\n);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"安全不等-lt-gt-结果不包含null，如果需要null要特判\"><a href=\"#安全不等-lt-gt-结果不包含null，如果需要null要特判\" class=\"headerlink\" title=\"安全不等<> 结果不包含null，如果需要null要特判\"></a>安全不等&lt;&gt; 结果不包含null，如果需要null要特判</h4><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">select name \nfrom patients\nwhere infected_by_id &lt;&gt; 2 or infected_by_id is null;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"group-by-不能直接用max\"><a href=\"#group-by-不能直接用max\" class=\"headerlink\" title=\"group by 不能直接用max\"></a>group by 不能直接用max</h3><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">select t.student_id\nfrom (\n    select student_id, count(*) as c\n    from exams e\n    where e.is_pass=0\n    group by e.student_id\n    ) as t\n,(\n    select count(*) cc\n    from exams ee\n    where ee.is_pass=0\n    group by ee.student_id\n) f \nwhere t.c = max(f.cc) #错误<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">select t.student_id\nfrom (\n    select student_id, count(*) as c\n    from exams e\n    where e.is_pass=0\n    group by e.student_id\n    ) as t\n,(select max(cc) acount from (\n    select count(*) cc\n    from exams ee\n    where ee.is_pass=0\n    group by ee.student_id\n) f ) ff\nwhere t.c = ff.acount;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"寻找连续两行\"><a href=\"#寻找连续两行\" class=\"headerlink\" title=\"寻找连续两行\"></a>寻找连续两行</h3><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">select distinct a.id \nfrom boxes a,boxes b \nwhere abs(a.id-b.id) = 1 and (a.is_empty=1 and b.is_empty=1)\norder by a.id ;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"空值就不输出\"><a href=\"#空值就不输出\" class=\"headerlink\" title=\"空值就不输出\"></a>空值就不输出</h3><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">having ... is not null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3 id=\"保留小数点后2位\"><a href=\"#保留小数点后2位\" class=\"headerlink\" title=\"保留小数点后2位\"></a>保留小数点后2位</h3><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">round(score,2)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n","text":"笔记空值输出nullselect ifnull((select ... from ...),null) as ans; 获取去重的第k名select ... from group by ... order by ... desc limit k-1,1 ; 删除操作，保留一部分d...","link":"","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"数据库","slug":"数据库","count":4,"path":"api/categories/数据库.json"}],"tags":[{"name":"MySQL","slug":"MySQL","count":3,"path":"api/tags/MySQL.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AC%94%E8%AE%B0\"><span class=\"toc-text\">笔记</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%A9%BA%E5%80%BC%E8%BE%93%E5%87%BAnull\"><span class=\"toc-text\">空值输出null</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E5%8E%BB%E9%87%8D%E7%9A%84%E7%AC%ACk%E5%90%8D\"><span class=\"toc-text\">获取去重的第k名</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C%EF%BC%8C%E4%BF%9D%E7%95%99%E4%B8%80%E9%83%A8%E5%88%86\"><span class=\"toc-text\">删除操作，保留一部分</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%85%88select%E5%86%8Ddelect%E4%BC%9A%E6%8A%A5%E9%94%99%EF%BC%8C%E4%B8%AD%E9%97%B4%E8%A6%81%E5%86%8D%E5%8A%A0%E4%B8%80%E5%B1%82select\"><span class=\"toc-text\">先select再delect会报错，中间要再加一层select</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#from-%E5%AD%90%E6%9F%A5%E8%AF%A2-%EF%BC%8C%E5%AD%90%E6%9F%A5%E8%AF%A2%E8%A6%81%E8%B5%B7%E5%88%AB%E5%90%8D\"><span class=\"toc-text\">from 子查询 ，子查询要起别名</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#in%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%8F%AF%E4%BB%A5-in-%E4%B8%80%E5%AF%B9%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">in子查询可以 in 一对数据</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AE%89%E5%85%A8%E4%B8%8D%E7%AD%89-lt-gt-%E7%BB%93%E6%9E%9C%E4%B8%8D%E5%8C%85%E5%90%ABnull%EF%BC%8C%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81null%E8%A6%81%E7%89%B9%E5%88%A4\"><span class=\"toc-text\">安全不等&lt;&gt; 结果不包含null，如果需要null要特判</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#group-by-%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E7%94%A8max\"><span class=\"toc-text\">group by 不能直接用max</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AF%BB%E6%89%BE%E8%BF%9E%E7%BB%AD%E4%B8%A4%E8%A1%8C\"><span class=\"toc-text\">寻找连续两行</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%A9%BA%E5%80%BC%E5%B0%B1%E4%B8%8D%E8%BE%93%E5%87%BA\"><span class=\"toc-text\">空值就不输出</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BF%9D%E7%95%99%E5%B0%8F%E6%95%B0%E7%82%B9%E5%90%8E2%E4%BD%8D\"><span class=\"toc-text\">保留小数点后2位</span></a></li></ol></li></ol>","author":{"name":"YFR718","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/47553658?s=400&u=5e0a85700c66d7a2661c5664ec5f24d94e5ed01a&v=4","link":"/","description":"大数据萌新","socials":{"github":"https://github.com/YFR718","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"d","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Zookeeper","uid":"a21b04ca115a88f58bf8270c3847c249","slug":"B9-zookeeper","date":"2021-11-26T06:25:15.000Z","updated":"2021-12-06T07:36:49.255Z","comments":true,"path":"api/articles/B9-zookeeper.json","keywords":null,"cover":"https://img-blog.csdnimg.cn/799dba0361cb4697a0776df265d40e21.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWUZSNzE4,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center","text":"Zookeeper简介​ Zookeeper 是一个开源的分布式的，为分布式框架提供协调服务的 Apache 项目。 ​ Zookeeper从设计模式角度来理解：是一个基于观察者模式设计的分布式服务管理框架，它负责存储和管理大家都关心的数据，然 后接受观察者的注 册，一旦这些数据...","link":"","photos":[],"count_time":{"symbolsCount":"3.4k","symbolsTime":"3 mins."},"categories":[{"name":"大数据","slug":"大数据","count":6,"path":"api/categories/大数据.json"}],"tags":[{"name":"Zookeeper","slug":"Zookeeper","count":1,"path":"api/tags/Zookeeper.json"}],"author":{"name":"YFR718","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/47553658?s=400&u=5e0a85700c66d7a2661c5664ec5f24d94e5ed01a&v=4","link":"/","description":"大数据萌新","socials":{"github":"https://github.com/YFR718","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"d","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"J8.JDBC","uid":"62ef56c51053b490f9a79e2b56de5f36","slug":"J8-JDBC","date":"2021-11-25T12:03:14.000Z","updated":"2021-11-25T12:33:08.385Z","comments":true,"path":"api/articles/J8-JDBC.json","keywords":null,"cover":"https://img-blog.csdnimg.cn/5376921c8a724ba49052ab7b5f218d54.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWUZSNzE4,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center","text":"JDBC核心技术第1章：JDBC概述1.1 数据的持久化 持久化(persistence)：把数据保存到可掉电式存储设备中以供之后使用。大多数情况下，特别是企业级应用，数据持久化意味着将内存中的数据保存到硬盘上加以”固化”，而持久化的实现过程大多通过各种关系数据库来完成。 持久化...","link":"","photos":[],"count_time":{"symbolsCount":"48k","symbolsTime":"44 mins."},"categories":[{"name":"JAVA","slug":"JAVA","count":10,"path":"api/categories/JAVA.json"}],"tags":[{"name":"java","slug":"java","count":9,"path":"api/tags/java.json"}],"author":{"name":"YFR718","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/47553658?s=400&u=5e0a85700c66d7a2661c5664ec5f24d94e5ed01a&v=4","link":"/","description":"大数据萌新","socials":{"github":"https://github.com/YFR718","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"d","csdn":"","juejin":"","customs":{}}}}}