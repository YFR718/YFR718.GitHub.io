{"title":"B4.大数据常用shell脚本","uid":"c8964ce203e761cbb3c6f466ff1217cb","slug":"B4-大数据常用shell脚本","date":"2021-11-16T08:46:58.000Z","updated":"2021-11-16T08:55:31.635Z","comments":true,"path":"api/articles/B4-大数据常用shell脚本.json","keywords":null,"cover":"https://img-blog.csdnimg.cn/a277ba5acebf4be9b68f076d7fab598b.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWUZSNzE4,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center","content":"<h1 id=\"常见shell脚本\"><a href=\"#常见shell脚本\" class=\"headerlink\" title=\"常见shell脚本\"></a>常见shell脚本</h1><h2 id=\"集群见文件同步\"><a href=\"#集群见文件同步\" class=\"headerlink\" title=\"集群见文件同步\"></a>集群见文件同步</h2><pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">#!/bin/bash\n\n#1. 判断参数个数\nif [ $# -lt 1 ]\nthen\n    echo Not Enough Arguement!\n    exit;\nfi\n\n#2. 遍历集群所有机器\nfor host in hadoop102 hadoop103 hadoop104\ndo\n    echo ====================  $host  ====================\n    #3. 遍历所有目录，挨个发送\n\n    for file in $@\n    do\n        #4. 判断文件是否存在\n        if [ -e $file ]\n            then\n                #5. 获取父目录\n                pdir=$(cd -P $(dirname $file); pwd)\n\n                #6. 获取当前文件的名称\n                fname=$(basename $file)\n                ssh $host \"mkdir -p $pdir\"\n                rsync -av $pdir/$fname $host:$pdir\n            else\n                echo $file does not exists!\n        fi\n    done\ndone\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"启动停止hadoop集群\"><a href=\"#启动停止hadoop集群\" class=\"headerlink\" title=\"启动停止hadoop集群\"></a>启动停止hadoop集群</h2><pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">\n#!/bin/bash\n\nif [ $# -lt 1 ]\nthen\n    echo \"No Args Input...\"\n    exit ;\nfi\n\ncase $1 in\n\"start\")\n        echo \" =================== 启动 hadoop集群 ===================\"\n\n        echo \" --------------- 启动 hdfs ---------------\"\n        ssh hadoop102 \"/opt/module/hadoop-3.1.3/sbin/start-dfs.sh\"\n        echo \" --------------- 启动 yarn ---------------\"\n        ssh hadoop103 \"/opt/module/hadoop-3.1.3/sbin/start-yarn.sh\"\n        echo \" --------------- 启动 historyserver ---------------\"\n        ssh hadoop102 \"/opt/module/hadoop-3.1.3/bin/mapred --daemon start historyserver\"\n;;\n\"stop\")\n        echo \" =================== 关闭 hadoop集群 ===================\"\n\n        echo \" --------------- 关闭 historyserver ---------------\"\n        ssh hadoop102 \"/opt/module/hadoop-3.1.3/bin/mapred --daemon stop historyserver\"\n        echo \" --------------- 关闭 yarn ---------------\"\n        ssh hadoop103 \"/opt/module/hadoop-3.1.3/sbin/stop-yarn.sh\"\n        echo \" --------------- 关闭 hdfs ---------------\"\n        ssh hadoop102 \"/opt/module/hadoop-3.1.3/sbin/stop-dfs.sh\"\n;;\n*)\n    echo \"Input Args Error...\"\n;;\nesac\n\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"查看集群jps\"><a href=\"#查看集群jps\" class=\"headerlink\" title=\"查看集群jps\"></a>查看集群jps</h2><pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">#!/bin/bash\n\nfor host in hadoop102 hadoop103 hadoop104\ndo\n        echo =============== $host ===============\n        ssh $host jps\ndone\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"hive\"><a href=\"#hive\" class=\"headerlink\" title=\"hive\"></a>hive</h2><pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">#!/bin/bash \nHIVE_LOG_DIR=$HIVE_HOME/logs\nif [ ! -d $HIVE_LOG_DIR ]\nthen\n    mkdir -p $HIVE_LOG_DIR\nfi\n#检查进程是否运行正常，参数 1为进程名，参数 2为进程端口\nfunction check_process() \n{\n   pid=$(ps -ef 2&gt;/dev/null | grep -v grep | grep -i $1 | awk '{print $2}')\n   ppid=$(netstat -nltp 2&gt;/dev/null | grep $2 | awk '{print $7}' | cut -d '/' -f 1)\n   echo $pid  \n   [[ \"$pid\" =~ \"$ppid\" ]] &amp;&amp; [ \"$ppid\" ] &amp;&amp; return 0 || return 1\n}\nfunction hive_start() \n{\n   metapid=$(check_process HiveMetastore 9083)\n   cmd=\"nohup hive --service metastore &gt;$HIVE_LOG_DIR/metastore.log 2&gt;&amp;1 &amp;\"\n   [ -z \"$metapid\" ] &amp;&amp; eval $cmd || echo \"Metastroe服务已启动\"\n   server2pid=$(check_process HiveServer2 10000)\n   cmd=\"nohup hiveserver2 &gt;$HIVE_LOG_DIR/hiveServer2.log 2&gt;&amp;1 &amp;\"\n   [ -z \"$server2pid\" ] &amp;&amp; eval $cmd || echo \"HiveServer2服务已启动\"\n}\nfunction hive_stop() \n{\n    metapid=$(check_process HiveMetastore 9083)\n    [ \"$metapid\" ] &amp;&amp; kill $metapid || echo \"Metastore服务未启动\"\n    server2pid=$(check_process HiveServer2 10000)\n    [ \"$server2pid\" ] &amp;&amp; kill $server2pid || echo \"HiveServer2服务未启动\"\n}\ncase $1 in\n\"start\")\nhive_start\n;;\n\"stop\")\nhive_stop\n;;\n\"restart\")\nhive_stop\nsleep 2\nhive_start\n;;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","text":"常见shell脚本集群见文件同步#!/bin/bash #1. 判断参数个数 if [ $# -lt 1 ] then echo Not Enough Arguement! exit; fi #2. 遍历集群所有机器 for host in hadoop102 hadoop103...","link":"","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[{"name":"大数据","slug":"大数据","count":5,"path":"api/categories/大数据.json"}],"tags":[{"name":"shell","slug":"shell","count":1,"path":"api/tags/shell.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E8%A7%81shell%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">常见shell脚本</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%9B%86%E7%BE%A4%E8%A7%81%E6%96%87%E4%BB%B6%E5%90%8C%E6%AD%A5\"><span class=\"toc-text\">集群见文件同步</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8%E5%81%9C%E6%AD%A2hadoop%E9%9B%86%E7%BE%A4\"><span class=\"toc-text\">启动停止hadoop集群</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4jps\"><span class=\"toc-text\">查看集群jps</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#hive\"><span class=\"toc-text\">hive</span></a></li></ol></li></ol>","author":{"name":"YFR718","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/47553658?s=400&u=5e0a85700c66d7a2661c5664ec5f24d94e5ed01a&v=4","link":"/","description":"大数据萌新","socials":{"github":"https://github.com/YFR718","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"d","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"B5.Hadoop案例","uid":"60afbd6afe5dbba07afaea373a4f245b","slug":"B5-MapReduce案例","date":"2021-11-17T11:17:27.000Z","updated":"2021-11-17T14:24:02.810Z","comments":true,"path":"api/articles/B5-MapReduce案例.json","keywords":null,"cover":"https://img-blog.csdnimg.cn/5376921c8a724ba49052ab7b5f218d54.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWUZSNzE4,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center","text":"MapReduceWordCount案例实操 创建maven工程，MapReduceDemo 在pom.xml文件中添加如下依赖 &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hadoop&lt...","link":"","photos":[],"count_time":{"symbolsCount":"62k","symbolsTime":"56 mins."},"categories":[{"name":"大数据","slug":"大数据","count":5,"path":"api/categories/大数据.json"}],"tags":[{"name":"Hadoop","slug":"Hadoop","count":3,"path":"api/tags/Hadoop.json"}],"author":{"name":"YFR718","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/47553658?s=400&u=5e0a85700c66d7a2661c5664ec5f24d94e5ed01a&v=4","link":"/","description":"大数据萌新","socials":{"github":"https://github.com/YFR718","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"d","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"shell编程ing","uid":"35292c50fe93e1c9375839d3cf5431cb","slug":"B3-shell编程","date":"2021-11-16T08:46:40.000Z","updated":"2021-11-16T08:58:22.628Z","comments":true,"path":"api/articles/B3-shell编程.json","keywords":null,"cover":"https://img-blog.csdnimg.cn/072c6dbbbb4f421490a43bbba385f4d1.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWUZSNzE4,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center","text":"shell编程 shell基础Shell是一个命令行解释器，它接收应用程序/用户命令,然后调用操作系统内核。 Shel解析器（1）Linux提供的Shell解析器有： [atguigu@hadoop101 ~]$ cat /etc/shells /bin/sh /bin/bash...","link":"","photos":[],"count_time":{"symbolsCount":"4.7k","symbolsTime":"4 mins."},"categories":[{"name":"大数据","slug":"大数据","count":5,"path":"api/categories/大数据.json"}],"tags":[{"name":"Hadoop","slug":"Hadoop","count":3,"path":"api/tags/Hadoop.json"}],"author":{"name":"YFR718","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/47553658?s=400&u=5e0a85700c66d7a2661c5664ec5f24d94e5ed01a&v=4","link":"/","description":"大数据萌新","socials":{"github":"https://github.com/YFR718","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"d","csdn":"","juejin":"","customs":{}}}}}